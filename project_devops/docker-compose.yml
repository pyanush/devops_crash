version: "2.3"
services:
  sftp:
    build: sftp/
    volumes: 
        - /home/mykola/upload/:/home/foo/upload/
    ports:
        - "223:22"
    command: foo:pass:1001

  python:
    build: python/
    volumes: 
      - /home/mykola/upload/logs:/app/logs/
      - /home/mykola/upload/result:/app/result/

  nginx:
    build: nginx/
    ports: 
       - "8080:80"

  



    healthcheck:
        test:  ["CMD-SHELL", "test -f /upload/logfile.log"] 
        interval: 3s
        timeout: 5s
        retries: 50
        start_period: 1s
   






























   nginx:
     build: /home/mykola/lesson12/project_devops/nginx
     ports:
       - "8000:80"
     volumes:
       - /root/docker/redis:/data
     depends_on:
       redis:
         condition: service_healthy
     environment:
       - ENV=development
   redis:
     image: redis
     volumes:
       - /root/docker/redis:/data
     healthcheck:
       test: ["CMD", "redis-cli", "-v"]
       interval: 3s
       timeout: 5s
       retries: 5
       start_period: 1s